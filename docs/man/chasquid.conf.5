.\" -*- mode: troff; coding: utf-8 -*-
.\" Automatically generated by Pod::Man 5.0102 (Pod::Simple 3.45)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" \*(C` and \*(C' are quotes in nroff, nothing in troff, for use with C<>.
.ie n \{\
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds C`
.    ds C'
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is >0, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.\"
.\" Avoid warning from groff about undefined register 'F'.
.de IX
..
.nr rF 0
.if \n(.g .if rF .nr rF 1
.if (\n(rF:(\n(.g==0)) \{\
.    if \nF \{\
.        de IX
.        tm Index:\\$1\t\\n%\t"\\$2"
..
.        if !\nF==2 \{\
.            nr % 0
.            nr F 2
.        \}
.    \}
.\}
.rr rF
.\" ========================================================================
.\"
.IX Title "chasquid.conf 5"
.TH chasquid.conf 5 2025-06-07 "" ""
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH NAME
chasquid.conf(5) \-\- chasquid configuration file
.SH SYNOPSIS
.IX Header "SYNOPSIS"
\&\fBchasquid.conf\fR\|(5) is \fBchasquid\fR\|(1)'s main configuration file.
.SH DESCRIPTION
.IX Header "DESCRIPTION"
The file is in protocol buffers' text format.
.PP
Comments start with \f(CW\*(C`#\*(C'\fR. Empty lines are allowed.  Values are of the form
\&\f(CW\*(C`key: value\*(C'\fR. Values can be strings (quoted), integers, or booleans (\f(CW\*(C`true\*(C'\fR or
\&\f(CW\*(C`false\*(C'\fR).
.PP
Some values might be repeated, for example the listening addresses.
.SH OPTIONS
.IX Header "OPTIONS"
.IP "\fBhostname\fR (string):" 8
.IX Item "hostname (string):"
Default hostname to use when saying hello. This is used to say hello to
clients (for aesthetic purposes), and as the HELO/EHLO domain on outgoing SMTP
connections (so ideally it would resolve back to the server, but it isn't a
big deal if it doesn't). Default: the system's hostname.
.IP "\fBmax_data_size_mb\fR (int):" 8
.IX Item "max_data_size_mb (int):"
Maximum email size, in megabytes. Default: 50.
.IP "\fBsmtp_address\fR (repeated string):" 8
.IX Item "smtp_address (repeated string):"
Addresses to listen on for SMTP (usually port 25). Default: "systemd", which
means systemd passes sockets to us. systemd sockets must be named with
\&\fBFileDescriptorName=smtp\fR.
.IP "\fBsubmission_address\fR (repeated string):" 8
.IX Item "submission_address (repeated string):"
Addresses to listen on for submission (usually port 587). Default: "systemd",
which means systemd passes sockets to us. systemd sockets must be named with
\&\fBFileDescriptorName=submission\fR.
.IP "\fBsubmission_over_tls_address\fR (repeated string):" 8
.IX Item "submission_over_tls_address (repeated string):"
Addresses to listen on for submission-over-TLS (usually port 465). Default:
"systemd", which means systemd passes sockets to us. systemd sockets must be
named with \fBFileDescriptorName=submission_tls\fR.
.IP "\fBmonitoring_address\fR (string):" 8
.IX Item "monitoring_address (string):"
Address for the monitoring HTTP server. Do NOT expose this to the public
internet. Default: no monitoring server.
.IP "\fBmail_delivery_agent_bin\fR (string):" 8
.IX Item "mail_delivery_agent_bin (string):"
Mail delivery agent (MDA, also known as LDA) to use. This should point
to the binary to use to deliver email to local users. The content of the
email will be passed via stdin. If it exits unsuccessfully, we assume
the mail was not delivered. Default: \fImaildrop\fR.
.IP "\fBmail_delivery_agent_args\fR (repeated string):" 8
.IX Item "mail_delivery_agent_args (repeated string):"
Command line arguments for the mail delivery agent. One per argument.
Some replacements will be done.
.Sp
On an email sent from marsnik@mars to venera@venus:
.Sp
.Vb 6
\&    %from%        \-> from address (marsnik@mars)
\&    %from_user%   \-> from user (marsnik)
\&    %from_domain% \-> from domain (mars)
\&    %to%          \-> to address (venera@venus)
\&    %to_user%     \-> to user (venera)
\&    %to_domain%   \-> to domain (venus)
.Ve
.Sp
Default: \f(CW"\-f", "%from%", "\-d", "%to_user%"\fR  (adequate for procmail and
maildrop).
.IP "\fBdata_dir\fR (string):" 8
.IX Item "data_dir (string):"
Directory where we store our persistent data. Default:
\&\fI/var/lib/chasquid\fR.
.IP "\fBsuffix_separators\fR (string):" 8
.IX Item "suffix_separators (string):"
Suffix separator, to perform suffix removal of local users.  For
example, if you set this to \f(CW\*(C`\-+\*(C'\fR, email to local user \f(CW\*(C`user\-blah\*(C'\fR and
\&\f(CW\*(C`user+blah\*(C'\fR will be delivered to \f(CW\*(C`user\*(C'\fR.  Including \f(CW\*(C`+\*(C'\fR is strongly
encouraged, as it is assumed for email forwarding.  Default: \f(CW\*(C`+\*(C'\fR.
.IP "\fBdrop_characters\fR (string):" 8
.IX Item "drop_characters (string):"
Characters to drop from the user part on local emails.  For example, if
you set this to \f(CW\*(C`._\*(C'\fR, email to local user \f(CW\*(C`u.se_r\*(C'\fR will be delivered to
\&\f(CW\*(C`user\*(C'\fR.  Default: \f(CW\*(C`.\*(C'\fR.
.IP "\fBmail_log_path\fR (string):" 8
.IX Item "mail_log_path (string):"
Path where to write the mail log to.  If \f(CW\*(C`<syslog>\*(C'\fR, log using the
syslog (at \f(CW\*(C`MAIL|INFO\*(C'\fR priority).  If \f(CW\*(C`<stdout>\*(C'\fR, log to stdout; if
\&\f(CW\*(C`<stderr>\*(C'\fR, log to stderr.  Default: \f(CW\*(C`<syslog>\*(C'\fR.
.IP "\fBdovecot_auth\fR (bool):" 8
.IX Item "dovecot_auth (bool):"
Enable dovecot authentication. If true, users that are not found in chasquid's
databases will be authenticated via dovecot.  Default: \f(CW\*(C`false\*(C'\fR.
.Sp
The path to dovecot's auth sockets is autodetected, but can be manually
overridden using the \f(CW\*(C`dovecot_userdb_path\*(C'\fR and \f(CW\*(C`dovecot_client_path\*(C'\fR if
needed.
.IP "\fBhaproxy_incoming\fR (bool):" 8
.IX Item "haproxy_incoming (bool):"
If true, expect incoming SMTP connections to use the HAProxy protocol.
This allows deploying chasquid behind a HAProxy server, as the address
information is preserved, and SPF checks can be performed properly.
Default: \f(CW\*(C`false\*(C'\fR.
.IP "\fBmax_queue_items\fR (int):" 8
.IX Item "max_queue_items (int):"
\&\fBEXPERIMENTAL\fR, might change in backwards-incompatible ways.
.Sp
Maximum number of items in the queue.
.Sp
If we have this many items in the queue, we reject new incoming email. Be
careful when increasing this, as we keep all items in memory.
Default: \f(CW200\fR (but may change in the future).
.IP "\fBgive_up_send_after\fR (string):" 8
.IX Item "give_up_send_after (string):"
\&\fBEXPERIMENTAL\fR, might change in backwards-incompatible ways.
.Sp
How long do we keep retrying sending an email before we give up.  Once we give
up, a DSN will be sent back to the sender.
.Sp
The format is a Go duration string (e.g. "48h" or "360m"; note days are not a
supported unit). Default: \f(CW"20h"\fR (but may change in the future).
.SH "SEE ALSO"
.IX Header "SEE ALSO"
\&\fBchasquid\fR\|(1)
